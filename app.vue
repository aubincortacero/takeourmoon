<!-- app.vue (ou pages/missions.vue si ton routing est OK) -->
<script setup>
import SectionHeader from '../components/SectionHeader.vue'
import Header from '../components/Header.vue'
import Footer from '../components/Footer.vue'
import SectionMissions from './components/SectionMissions.vue'
import SectionMoon from './components/SectionMoon.vue'
import SectionRegolithe from './components/SectionRegolithe.vue'
import Lenis from '@studio-freight/lenis'
import gsap from 'gsap'
import ScrollTrigger from 'gsap/ScrollTrigger'
import { onMounted, nextTick } from 'vue'
import { VueLenis, useLenis } from 'lenis/vue' // Also available as global imports, no need to import them manually
import { watch } from 'vue'

// état largeur fenêtre
const windowWidth = ref(0)
const updateWidth = () => (windowWidth.value = window.innerWidth)


useHead({
  title: 'Takeourmoon - Démo Nuxt',
  meta: [
    { name: 'description', content: 'Projet demo Nuxt - Takeourmoon' },
    { property: 'og:title', content: 'Takeourmoon' }
  ],
  link: [
    { rel: 'icon', href: '/favicon.ico' }
  ]
})

onMounted(async () => {

//attends que le model 3d soit visible 
  await nextTick()
 
  gsap.registerPlugin(ScrollTrigger)
  const lenisOptions = {
    autoRaf: false,
    anchors: {
      offset: 100,
      onComplete: ()=>{
        console.log('scrolled to anchor')
      }
    } 
  } 

  const lenis = useLenis((lenis) => {
    // called every scroll
    // console.log(lenis)
  })

  watch(
    lenis,
    (lenis) => {
      // lenis instance

    },
    { immediate: true }
  )

// Ajuster ScrollTrigger pour qu'il fonctionne avec Lenis
gsap.ticker.lagSmoothing(0);


  updateWidth()
  window.addEventListener('resize', updateWidth)

  // choisir les valeurs selon breakpoint
  const isMobile = windowWidth.value < 780

  const leftValue = isMobile ? '-230vw' : '-130vw'
  const rightValue = isMobile ? '-230vw' : '-130vw'

  gsap.to('.rideaugauche', { left: leftValue, duration: 2, ease: 'power4.out' })
  gsap.to('.rideaudroite', { right: rightValue, duration: 2, ease: 'power4.out' })

  gsap.to('.loading', { opacity: 0, duration: 1, ease: 'power4.out' })
  gsap.to('.logocenter', { opacity: 0, duration: 1, ease: 'power4.out' })
  
})

</script>

<template>
  <VueLenis root :options="lenisOptions" />
  <div class="ecran"></div>
      <div class="logocenter">
     <svg xmlns="http://www.w3.org/2000/svg" width="281.845" height="380.738" viewBox="0 0 281.845 380.738"><g transform="translate(17351.868 225.15)"><path d="M103.65-105.15H51.9v18.3H67.2V-.15h21v-86.7h15.45Zm7.5,0L99.45-.15h21L122.7-26.1h9.15l2.4,25.95h21L144-105.15Zm13.2,60.75,2.25-25.05h1.5l2.1,25.05Zm55.2-60.6h-21V0h21V-43.35h2.1L191.25,0h22.2L198.9-52.5,212.25-105H189.9l-8.25,43.5h-2.1ZM255-86.85v-18.3H216.75V0h38.7V-18.3h-17.7V-45.9H254.7V-64.2H237.75V-86.85ZM27.9,40.8V94.05c0,18.45,10.5,27.45,26.85,27.45,16.65,0,27.45-9.15,27.45-27.45V40.8c0-18.15-10.8-27.3-27.45-27.3C38.4,13.5,27.9,22.35,27.9,40.8Zm21-1.35c0-5.85,3-7.65,6.15-7.65,3.3,0,6.15,1.8,6.15,7.65v56.1c0,5.7-2.85,7.8-6.15,7.8-3.15,0-6.15-2.1-6.15-7.8ZM87,15V94.05c0,18.45,10.2,27.45,26.55,27.45,16.5,0,27-9.15,27-27.45V15h-21V95.55c0,5.7-2.7,7.8-5.7,7.8s-5.85-2.1-5.85-7.8V15Zm58.5,0V120.15h21V79.95h4.8c4.5,0,6.6,2.4,6.6,7.8v10.8c0,8.1.15,15.15,1.5,21.45h21c-1.35-5.85-1.5-12.3-1.5-21.3V97.2c0-15.3-8.1-24.9-15.45-25.65v-1.5c7.35-.75,15.45-9.45,15.45-26.25v-.75c0-18.6-10.05-28.05-27.45-28.05Zm21,18.3h4.8c4.5,0,6.6,2.55,6.6,7.95v12.3c0,5.55-2.1,8.1-6.6,8.1h-4.8ZM2.55,135V240H21.9l-2.25-68.55H21L29.7,240H43.65l8.7-68.55H53.7L51.45,240h19.2V135H43.5l-6,69H36l-6.15-69Zm73.2,25.8v53.25c0,18.45,10.5,27.45,26.85,27.45,16.65,0,27.45-9.15,27.45-27.45V160.8c0-18.15-10.8-27.3-27.45-27.3C86.25,133.5,75.75,142.35,75.75,160.8Zm21-1.35c0-5.85,3-7.65,6.15-7.65,3.3,0,6.15,1.8,6.15,7.65v56.1c0,5.7-2.85,7.8-6.15,7.8-3.15,0-6.15-2.1-6.15-7.8Zm38.1,1.35v53.25c0,18.45,10.5,27.45,26.85,27.45,16.65,0,27.45-9.15,27.45-27.45V160.8c0-18.15-10.8-27.3-27.45-27.3C145.35,133.5,134.85,142.35,134.85,160.8Zm21-1.35c0-5.85,3-7.65,6.15-7.65,3.3,0,6.15,1.8,6.15,7.65v56.1c0,5.7-2.85,7.8-6.15,7.8-3.15,0-6.15-2.1-6.15-7.8ZM228.45,135l4.95,69h-1.2l-15-69H194.1V240h21l-4.65-68.55h1.2L226.2,240h23.25V135Z" transform="translate(-17354 -120)"/><path d="M11.443-4.238A4.183,4.183,0,0,1,7.937-5.852a5.039,5.039,0,0,1-.69-4.293,7.812,7.812,0,0,1,2.331-4.184A5.862,5.862,0,0,1,13.7-16.01a5.082,5.082,0,0,1,2.516.588,3.158,3.158,0,0,1,1.477,3.5H16.037a2.431,2.431,0,0,0-.485-1.777,2.366,2.366,0,0,0-1.989-.752,3.817,3.817,0,0,0-3.24,1.777,6.522,6.522,0,0,0-1.107,2.447,4.663,4.663,0,0,0,.26,3.151A2.457,2.457,0,0,0,11.881-5.8a3.467,3.467,0,0,0,2-.595A4.268,4.268,0,0,0,15.3-8.121h1.654a5.923,5.923,0,0,1-2.215,2.864A5.754,5.754,0,0,1,11.443-4.238Zm-3.8-11.949a10.735,10.735,0,0,0-3.8,6.111A7.18,7.18,0,0,0,5.031-3.924a6.613,6.613,0,0,0,5.551,2.543,10.2,10.2,0,0,0,6.645-2.543,10.829,10.829,0,0,0,3.787-6.152,7.072,7.072,0,0,0-1.2-6.111,6.576,6.576,0,0,0-5.537-2.543A10.179,10.179,0,0,0,7.643-16.187ZM18.02-2.953A11.845,11.845,0,0,1,10.295,0,7.8,7.8,0,0,1,3.8-2.953a8.226,8.226,0,0,1-1.422-7.123,12.359,12.359,0,0,1,4.443-7.082,11.962,11.962,0,0,1,7.738-2.926,7.787,7.787,0,0,1,6.48,2.926,8.108,8.108,0,0,1,1.436,7.082A12.46,12.46,0,0,1,18.02-2.953ZM34.809-8.23,33.646-17.1,28.52-8.23ZM32.867-20.084h3.076L38.965,0h-2.98l-.766-6.016H27.275L23.83,0H21.041Zm15.791,0L46.02-7.67a6.813,6.813,0,0,0,.041,3.637q.752,2.188,3.637,2.188a6.066,6.066,0,0,0,5.209-2.365A8.993,8.993,0,0,0,56.314-7.67l2.639-12.414h2.762L59.309-8.8a15.334,15.334,0,0,1-2.2,5.7A8.871,8.871,0,0,1,49.41.533q-5.086,0-6.125-3.637a12.473,12.473,0,0,1,.205-5.7L45.9-20.084Zm23.01,8.49a6.778,6.778,0,0,0,2.775-.479,3.579,3.579,0,0,0,2.078-2.707q.424-1.969-1.025-2.652a6.636,6.636,0,0,0-2.611-.383H68.031l-1.312,6.221Zm-1.053,9.27a5.062,5.062,0,0,0,3.869-1.449,4.622,4.622,0,0,0,1.148-2.215,2.349,2.349,0,0,0-1.326-2.98,6.648,6.648,0,0,0-2.652-.424h-5.4l-1.5,7.068Zm-4.758-17.76h8.627q3.527,0,4.566,2.105a4.265,4.265,0,0,1,.26,2.871,5.646,5.646,0,0,1-1.736,3.117,7.1,7.1,0,0,1-1.859,1.176,5.218,5.218,0,0,1,2.023,1.326,4.114,4.114,0,0,1,.588,3.623,7,7,0,0,1-1.969,3.514A8.4,8.4,0,0,1,70.082,0h-8.49Zm19.359,0h2.748L83.7,0H80.951Zm7.164,0h3.213l6.686,16.27,3.459-16.27h2.584L104.057,0h-3.049l-6.85-16.256L90.713,0h-2.6Zm35.656,6.029h-2.652a4.355,4.355,0,0,0-1.148-3.076,4.775,4.775,0,0,0-3.541-1.135,7.486,7.486,0,0,0-5.229,2.085,11.777,11.777,0,0,0-3.179,6.392,8.285,8.285,0,0,0,.431,5.722q1.183,2.194,4.45,2.194a6.54,6.54,0,0,0,5.072-2.311,11.518,11.518,0,0,0,1.914-3.2h2.652a11.738,11.738,0,0,1-3.473,5.318A10.3,10.3,0,0,1,116.32.52,6.965,6.965,0,0,1,110.893-1.6q-2.529-2.8-1.285-8.654a13.819,13.819,0,0,1,3.9-7.287,10.65,10.65,0,0,1,7.67-3.09q3.814,0,5.5,2.01A5.749,5.749,0,0,1,128.037-14.055Zm20.713-3.158a9.838,9.838,0,0,1,.547,6.822,14.86,14.86,0,0,1-3.869,7.479,11.305,11.305,0,0,1-8.395,3.5q-4.635,0-6.631-3.062-1.736-2.953-.779-7.465a14.644,14.644,0,0,1,3.5-6.973,10.994,10.994,0,0,1,8.477-3.719Q146.918-20.631,148.75-17.213Zm-2.256,6.863a7.438,7.438,0,0,0-.636-5.7,5.049,5.049,0,0,0-4.6-2.16,8.146,8.146,0,0,0-5.544,2.14,11.244,11.244,0,0,0-3.315,6.31,8.187,8.187,0,0,0,.492,5.626q1.2,2.29,4.99,2.29a7.112,7.112,0,0,0,5.749-2.577A13.457,13.457,0,0,0,146.494-10.35Zm15.49-.533a6.121,6.121,0,0,0,3.192-.766,3.974,3.974,0,0,0,1.7-2.762q.451-2.146-.943-2.926a4.556,4.556,0,0,0-2.146-.41h-6.645L155.7-10.883Zm-7.055-9.2h9.3a8.221,8.221,0,0,1,3.637.67q2.557,1.285,1.832,4.744a6.49,6.49,0,0,1-1.374,2.953,7.327,7.327,0,0,1-2.481,1.846,3.013,3.013,0,0,1,1.5,1.258,4.12,4.12,0,0,1,.123,2.529l-.479,2.693a7.586,7.586,0,0,0-.164,1.709,1.288,1.288,0,0,0,.615,1.23l-.1.451h-3.336a2.273,2.273,0,0,1-.082-.67,11.436,11.436,0,0,1,.205-1.586l.547-3.35q.314-1.969-.9-2.639a5.54,5.54,0,0,0-2.379-.369H155.2L153.385,0h-2.721Zm34.016,0-.506,2.393h-6.768L177.912,0H175.15l3.76-17.691h-6.768l.506-2.393Zm8.2,11.854L195.986-17.1,190.859-8.23Zm-1.941-11.854h3.076L201.3,0h-2.98l-.766-6.016h-7.943L186.17,0h-2.789Zm28.273,6.029h-2.652a4.355,4.355,0,0,0-1.148-3.076,4.775,4.775,0,0,0-3.541-1.135,7.486,7.486,0,0,0-5.229,2.085,11.776,11.776,0,0,0-3.179,6.392,8.285,8.285,0,0,0,.431,5.722q1.183,2.194,4.45,2.194a6.54,6.54,0,0,0,5.072-2.311,11.518,11.518,0,0,0,1.914-3.2h2.652a11.738,11.738,0,0,1-3.473,5.318A10.3,10.3,0,0,1,211.764.52,6.965,6.965,0,0,1,206.336-1.6q-2.529-2.8-1.285-8.654a13.819,13.819,0,0,1,3.9-7.287,10.65,10.65,0,0,1,7.67-3.09q3.814,0,5.5,2.01A5.749,5.749,0,0,1,223.48-14.055Zm5.045-6.029h14.643l-.533,2.461h-11.99l-1.285,6.1h11.088L239.955-9.2H228.867l-1.449,6.809h12.2L239.107,0H224.26Zm25.8,9.2a6.121,6.121,0,0,0,3.192-.766,3.974,3.974,0,0,0,1.7-2.762q.451-2.146-.943-2.926a4.556,4.556,0,0,0-2.146-.41h-6.645l-1.449,6.863Zm-7.055-9.2h9.3a8.221,8.221,0,0,1,3.637.67q2.557,1.285,1.832,4.744a6.49,6.49,0,0,1-1.374,2.953,7.327,7.327,0,0,1-2.481,1.846,3.013,3.013,0,0,1,1.5,1.258,4.12,4.12,0,0,1,.123,2.529l-.479,2.693a7.586,7.586,0,0,0-.164,1.709,1.288,1.288,0,0,0,.615,1.23l-.1.451h-3.336a2.273,2.273,0,0,1-.082-.67,11.436,11.436,0,0,1,.205-1.586l.547-3.35q.314-1.969-.9-2.639a5.54,5.54,0,0,0-2.379-.369h-6.193L245.725,0H243Zm35.82,2.871a9.838,9.838,0,0,1,.547,6.822,14.86,14.86,0,0,1-3.869,7.479,11.305,11.305,0,0,1-8.395,3.5q-4.635,0-6.631-3.062-1.736-2.953-.779-7.465a14.644,14.644,0,0,1,3.5-6.973,10.994,10.994,0,0,1,8.477-3.719Q281.258-20.631,283.09-17.213Zm-2.256,6.863a7.438,7.438,0,0,0-.636-5.7,5.049,5.049,0,0,0-4.6-2.16,8.146,8.146,0,0,0-5.544,2.14,11.244,11.244,0,0,0-3.315,6.31,8.186,8.186,0,0,0,.492,5.626q1.2,2.29,4.99,2.29a7.112,7.112,0,0,0,5.749-2.577A13.457,13.457,0,0,0,280.834-10.35Z" transform="translate(-17354 155)"/></g></svg>
    </div>
    <div class="loading fc-black font-50 font-thundermediumitalic">Chargement...</div>
    <div class="rideaugauche"></div>
    <div class="rideaudroite"></div>
  
  <main class="p-8" id="wrapper">
    <Header />
    <SectionHeader />
    <SectionMissions />
    <SectionMoon />
    <SectionRegolithe />
    <Footer /> 
  </main>
</template>
